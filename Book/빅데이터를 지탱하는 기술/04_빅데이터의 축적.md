# 4-1 벌크 형과 스트리밍 형의 데이터 수집

## 객체 스토리지와 데이터 수집

빅데이터는 대부분 확장성이 높은 분산 스토리지(distributed strogae)에 저장된다.

분산 스토리지 중에서 가장 기본이 되는 건 객체 스토리지(object storage)이다. 

객체 스토리지
- 특징
    - 다수의 컴퓨터를 사용하여 파일을 여러 디스크에 복사함으로써 데이터 중복화 및 부하 분산을 실현
    - 파일 읽고 쓰기는 네트워크를 거쳐서 실행된다.
- 장점
    - 데이터는 항상 여러 디스크에 복사되기 때문에 일부 하드웨어가 고장 나더라도 데이터가 손실되지 않는다.
    - 데이터의 읽고 쓰기를 다수의 하드웨어에 분산함으로써 데이터 양이 늘어나도 성능이 떨어지는 일이 없도록 고안되어 있다.
- 단점
    - 소량의 데이터에 대해 비효율적이다.
    - 100 바이트 정도의 작은 파일을 자주 읽고 쓰는건 데이터양에 비해 통신 오버헤드가 너무 크다
- 적절한 데이터 크기
    - 효율적으로 처리할 수 있는 파일 크기는 대략 1MB ~ 1GB
    - 데이터 크기가 작고, 파일수가 많으면 통신 오버헤드가 너무 커진다
    - 데이터 크기가 크고, 파일수가 적으면 네트워크 전송에 시간이 걸려 예상치 못한 오류 발생률이 높아진다.
    - 작은 데이터는 모아서 하나로 만들고, 큰 데이터는 복수로 나누는 것을 고려하라
    
데이터 수집(data ingestion) : 수집한 데이터를 가공하여 집계 효율이 좋은 분산 스토리지를 만드는 일련의 프로세스 

## 벌크 형의 데이터 전송

전통적인 데이터 웨어하우스에서 사용되던 방식.

데이터베이스나 파일서버, 웹 서비스 등에서 각각의 방식(SQL, API)로 데이터를 추출

과거에 축적된 대량의 데이터가 이미 있는 경우나 기존의 DB에서 데이터를 추출하고 싶을 때 사용

벌크형 데이터 전송을 위한 ETL 서버가 필요
- 데이터 웨어하우스를 위한 ETL 도구
- 오픈소스 벌크 전송 도구
- 손수 작성한 스크립트

벌크형 전송의 파일 사이즈
- 100개의 파일을 전송하는데 100번 전송을 하고 있다면 모아서 전송하는 것이 좋다
- 너무 많은 양의 데이터를 한꺼번에 전송하려고 하는 것도 위험하다. 한 달 혹은 하루 단위로 태스크를 분해하라. 

재처리
- 데이터 전송의 신뢰성이 중요한 경우엔 가능한 한 벌크형 도구를 사용해야 한다.
- 뭔가 문제가 발생했을 때 여러번 데이터 전송을 재실행할 수 있다는 점이 벌크형의 장점이다.

워크플로
- 스트리밍형 전송은 특성상 실시간으로 계속 동작하는 것을 전제로 하므로 워크플로의 일부로 실행하지 않는다.
- 과거의 데이터를 빠짐없이 가져오거나 실패한 작업을 재실행할 것을 고려한다면, 벌크형 전송을 해야 한다.



