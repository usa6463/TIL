# Testing

- 테스트들은 서로에게 아무런 영향이 없어야 한다
- 테스트 작성을 시작하기 전에 작성해야 할 테스트 목록을 모두 적어둘 것.
- 신중한 등반가들은 등반할 때 두 다리와 두 팔 중 셋은 항상 고정한다. 초록 막대 상태에서 한 번에 한개의 테스트만 수정하라.
- 테스트는 테스트 대상이 되는 코드를 작성하기 직전에 작성하는 것이 좋다. 
- 단언(assert) 우선
  - 시스템을 개발할 때 첫번째 할 일 : 완료된 시스템이 어떨 거라는 story 작성하라
  - 특정 기능 개발할 때 첫번째 할 일 : 기능이 완료되면 통과할 수 있는 테스트부터 작성하라
  - 테스트 개발할 때 첫번째 할 일 : 완료될 때 통과해야 할 단언부터 작성하라
- 어떤 테스트 데이터를 사용할 것인가?
  - 테스트를 읽을 때 쉽고 따라가기 좋은 데이터를 사용하라
  - 1과 2 사이에 개념적 차이점이 없다면 1을 사용하라
  - 테스트 데이터에 대한 대안은 실제 세상에서 얻어진 데이터를 사용하는 것이다.
- 다음 테스트를 고를 때 무엇을 기준으로 할 것인가?
  - 새로운 무언가를 가르쳐 줄 수 있으며, 구현할 수 있다는 확신이 드는 테스트
  - 오퍼레이션이 아무 일도 하지 않는 경우를 먼저 테스트할 것
- 시작 테스트
  - 현실적인 테스트를 작성 시작한다면 많은 문제를 한번에 해결해야 할 것이다.
    - 적절한 입력값은 뭐고, 적절한 출력은 뭐고, 오퍼레이션은 어디에 둬야하고...
    - 정말 발견하기 쉬운 입력과 출력을 사용하는 것으로 시작하라
      - 소켓 기반 서버의 첫번째 테스트 예
        -     Socket = new Socket
              Message = "hello"
              Socket.write(message)
              AssertEquals(message, socket.read)
    - 이후 빨강/초록/리팩토링 고리로 들어가자
- 회귀 테스트(regression test)
  - 시스템 장애가 발생하면 해당 장애로 인하여 실패하는 테스트를 만들고, 통과할 경우엔 장애가 수정되었다고 볼 수 있는 테스트를 가장 간단하게 작성하라
- 자식 테스트
  - 원래 테스트 케이스의 깨지는 부분에 해당하는 작은 테스트 케이스를 작성하고 그 작은 테스트 케이스가 실행되도록 하라. 
  - 그 후 다시 원래의 큰 테스트 케이스를 추가하라
- Mock Object
  - 비용이 많이 들거나 복잡한 리소스에 의존하는 객체를 테스트해야할 때가 있을 것이다.
  - 그 때는 상수를 반환하게끔 만든 속임수 버전의 리소스를 만들면 된다. 
  - 고전적인 예로 데이터베이스 대응이 있는데, 대다수의 테스트는 마치 데이터베이스인 것처럼 행동하지만 실제로는 메모리에만 존재하는 객체를 통해 작성 가능
  - 성능과 견고함 이외에 모의 객체의 또 다른 가치는 가독성에 있다. 
    - 사실적인 데이터로 가득찬 테스트 데이터베이스를 사용한다면 끝에서 끝까지 읽기 쉽지 않다
  - 모의 객체는 모든 객체의 가시성에 대해 고민하도록 격려해서, 설계에서 커플링 감소하도록 한다
  - 프로젝트에 위험 요소가 추가 된다. 
    - 모의 객체가 진짜 객체와 동일하게 동작하지 않으면?
    - 모의 객체용 테스트 집합을 진짜 객체가 사용 가능해질때 그대로 적용해서 위험을 줄일 수 있다. 

## 참고
- [도서]테스트 주도 개발