# 2장 객체 생성과 파괴

## 생성자 대신 정적 팩토리 메소드 고려
- 정적 팩토리 메소드 장점
  - 이름을 가질 수 있음.
    - 이름으로 설명을 잘 나타낼 수 있으면 클라이언트 입장에서 코드 읽기 쉬움
  - 호출될 때 마다 객체 생성 안할 수 있음.
    - 인스턴스 미리 만들어두거나 캐싱하여 사용 가능
    - 플라이웨이트 패턴과 비슷
    - 정적 팩토리 메소드가 있으면 인스턴스 통제 클래스라고도 할 수 있다. 
      - 싱글턴
      - 인스턴스화 불가 클래(ex. java.util.Collections)
      - 불변 값 클래스
  - 반환 타입의 하위 타입 객체를 반환 가능
    - 인터페이스 기반 프레임워크 만드는 핵심 기술
  - 입력 매개변수에 따라 다른 클래스의 객체 반환 가능
  - 정적 팩터리 메소드를 작성하는 시점에는 반환할 객체의 클래스가 없어도 됨.
    - 어차피 상위의 타입으로 반환할 것이니
    - 서비스 제공자 프레임워크의(Service provider framework) 근간
      - ex) JDBC
      - 4개의 핵심 컴포넌트
        - 서비스 인터페이스: 구현체의 동작 정의
        - 제공자 등록 API: 구현체 등록에 사용
        - 서비스 접근 API: 클라이언트가 서비스의 인스턴스 접근에 사용
        - 서비스 제공자 인터페이스: 없다면 각 구현체를 인스턴스로 만들 때 리플렉션 사용 필요
          
- 정적 팩토리 메소드 단점
  - 정적 팩토리만 제공하면 하위 클래스 생성 불가
    - public, protected 생성자가 없으면 상속 불가
    - 상속해도 부모의 필드 값을 채우지 못하니깐 그런건가?(super(...) 를 호출하지 못하니)
    - 오히려 장점이 될 수 있음
      - 상속보다 컴포지션 사용하도록 유도
      - 불변 타입
  - 프로그래머가 찾기 어렵다
    - 생성자 처럼 API 설명에 명확히 드러나지 않음
    - 그래서 API 문서도 잘 쓰고 메소드 이름도 널리 알려진 규약을 따르는게 좋다.

정적 팩토리 메소드 예 (디자인 패턴의 팩토리 메소드 패턴과는 다르다)
```java
public static Boolean valueOf(boolean b) {
    return b ? Boolean.True : Boolean.False;
}
```

## 생성자에 매개변수가 많다면 빌더를 고려하라
- 빌더 외 객체 생성 방법
  - 점층적 생성자 패턴
    - 생성자를 오버로딩하여 매개변수 상황에 맞는 여러 생성자를 만드는 것. 클라이언트는 자신의 상황에 맞는 적절한 생성자 하나를 선택한다.
    - 매개변수가 많아질수록 코드 작성 및 읽기가 어려워진다. 
  - 자바빈즈 패턴
    - 빈 객체 생성 후 setter들을 호출하여 객체의 필드를 채우는 방식
    - 불변 달성이 불가능함
      - 스레드 안정성 떨어짐. 
    - 객체가 완성되기 전까지 일관성이 무너진 상태
      - 디버깅의 어려움
- 빌더 패턴은 파이썬이나 스칼라에 있는 명명된 선택적 매개변수를 흉내낸 것