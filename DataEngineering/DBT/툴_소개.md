## DBT란

- dbt(data build tool)는 데이터 분석가와 엔지니어가 웨어하우스의 데이터를 보다 효과적으로 변환할 수 있도록 하는 명령줄 도구
- dbt는 ELT에서 T에 해당한다
  - bigquery, redshift, snowflake와 같은 모던 DW에 잘 맞는다
  - dbt가 하는건 take code, compile it to SQL, run against db
- dbt는 2가지 컴포넌트를 가진다
  - compiler
  - runner 
- 세부 구성 요소
  - code for model
  - model: 하나의 SELECT문으로 표현되는 data transformation
  - materialization: 데이터 모델이 웨어하우스에 구축되는 전략
    - view
    - table
    - date-partitioned table 등
  - 정리하면, 모델은 sql문 코드로 표현된다. 모델은 구체화가 가능하고 구체화 전략에 따라 view, table, 파티션 테이블 등으로 구체화 된다.
- code
  - 코드는 SQL와 Jinja로 이뤄짐. 
  - ```python
    select * from {{ref('stripe_discounts')}}
    ```
  - 개발 환경에 따른 분기도 적용 가능 (아래는 Prod일 경우 최신 데이터만 사용, dev일 경우 3일치만 사용하도록 조건 적용)
  - ```python
    select * from {{ref('really_big_table')}}
    
    {% if incremental and target.schema == 'prod' %}
    where timestamp >= (select max(timestamp) from {{this}})
    {% else %}
    where timestamp >= dateadd(day, -3, current_date)
    {% endif %}
    ```
- dbt의 목표는 단순히 SQL transformation가 아니라 transformation 코드를 빌드하고 공유할 수 있도록 하는 것임.
  - 관련 라이브러리로 snowplow와 stripe가 있음. 둘 다 transformation 라이브러리
  - 이러한 환경은 analyst를 tool-user에서 tool-maker로 변화시키고 있음.
- 

### 참고
- [What is dbt?](https://docs.getdbt.com/docs/introduction)
- [What, exactly, is dbt?](https://www.getdbt.com/blog/what-exactly-is-dbt/)